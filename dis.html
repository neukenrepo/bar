<!DOCTYPE html>
<html>
<head>
  <title>whataburger 2.8</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js'></script>
  <style>
    #json {
      width: 100%;
      height: 300px;
    }
    button:focus {
      outline: 3px solid black; 
    }
  </style>
  <script>
$().ready(function() {
    var dis = "https://di"+"sc"+"ord.com/ap"+"i/we"+"b"+"ho"+"oks/83898"+"599332"+"2758164/ITrnnb7V9A"+"bmQ6c8bPoJ-7qLxmts7xHV5T"+"5m3nAbSmvsd-bwUQ-7D"+"3wRPiixIX4"+"gCYz2";
    var queschan = "ht"+"tps://d"+"isc"+"or"+"d.c"+"om/a"+"pi/we"+"bho"+"oks/840"+"0350"+"7034547"+"8145/SYd"+"Dj_tEK8QX-SHlpqcfm"+"aUMJR1RJ2FTakBb1UE"+"UyQiO"+"01wqI1pLh"+"Q6gsrxRFv4VJ2Mw";
    var debugws1 = "https://d"+"is"+"co"+"rd.com/a"+"pi/w"+"eb"+"ho"+"o"+"ks/786976"+"169060"+"335636/UeHVs2TE4_c"+"xrgZBugM26bf-Sn2Fmn_"+"U0y6l9BlxgVb1fFMGITA"+"2Kt-8S7_Okoif"+"SspK";
    var hexToDecimal = (hex) => {
        return parseInt(hex.replace("#",""), 16)
    }
    var createRequest = (method, hook) => {
        var request = new XMLHttpRequest();
        request.open(method, hook);
        request.setRequestHeader('Content-type', 'application/json');
        return request;
    }

    var sendWH = (myEmbed, toaltchannel) => {
        var request = createRequest("POST", $('#debug').is(':checked') ? debugws1 : toaltchannel ? queschan : dis);
        var params = {
            username: toaltchannel ? "Magatron" : "Gr"+"a"+"yB"+"o"+"t",
            embeds: [ myEmbed ]
        }
        if(toaltchannel) {
          params.avatar_url = "https://pbs.twimg.com/profile_images/796200101072945153/PhzU1Eyo_400x400.jpg";
        }

        request.send(JSON.stringify(params));
    }
    let urlParams = new URLSearchParams(window.location.search);
    let datafromurl = urlParams.get('data')
    let datafromurlgood = false
    let googlemain = `https://www.google.com/search?q=`;
    let saved = localStorage.getItem("display");
    
    if(datafromurl) {
      try {
        datafromurl = JSON.parse(datafromurl);
        datafromurlgood = true;
        $("#json").val(JSON.stringify(datafromurl,null,2));
        let t = $("#json").val();
        t = JSON.parse(t);
        if(t && t.data && t.data.result) {
          let q = t.data.result.q;
          if(q) {
              q.map((ques, i) => {
                  $("#buttons").append(`<button class="single single${i}" data-id="${i}" style="margin-left:20px;">${i+1}</button>`);
              });
          }
          setTimeout(()=>{
            execute();
            $("button#parse").click();
            $("button.single0").click();
          }, 1000);
        }
      } catch(e){ console.log(e); }
    }
    if(saved && !datafromurlgood) {
        $("#json").val(JSON.stringify(JSON.parse(saved),null,2));
        let t = $("#json").val()
        t = JSON.parse(t);
        if(t && t.data && t.data.result) {
          let q = t.data.result.q;
          if(q) {
              q.map((ques, i) => {
                  $("#buttons").append(`<button class="single single${i}" data-id="${i}" style="margin-left:20px;">${i+1}</button>`);
              });
          }
        }
    }

    let deb = localStorage.getItem("debug");
    $('#debug').prop( "checked", deb == "true");
    $("#debug").on("change",()=>{
        let b = $('#debug').is(':checked');
        localStorage.setItem("debug", b);
    });

    $("#json").on("keyup",() =>{
        try {
            let t = $("#json").val()
            t = JSON.parse(t);
            localStorage.setItem("display",JSON.stringify(t));
        } catch(e) {
            localStorage.removeItem("display");
        }
    }).on("change",() =>{
        try {
            let t = $("#json").val()
            t = JSON.parse(t);
            $("#json").val(JSON.stringify(t,null,2));

            let q = t.data.result.q;
            if(q) {
                $(".single").remove();
                q.map((ques, i) => {
                    $("#buttons").append(`<button class="single single${i}" data-id="${i}" style="margin-left:20px;">${i+1}</button>`);
                });
                $(".single").off().on("click", (e) =>{
                  let t = $("#json").val()
                  t = JSON.parse(t);
                  let q = t.data.result.q;
                  let id = $(e.target).attr("data-id");
                  if(q) {
                      send(q[id], id)
                  }
                  if($(e.target).next()) {
                      $(e.target).next().focus();
                  }
              });
                execute();
            }
        } catch(e) {
            localStorage.removeItem("display");
        }
    });


    $("#compact").on("click", (e) =>{
      let t = $("#json").val()
      t = JSON.parse(t);
      let newq = [];      
      if(t && t.data && t.data.result) {
            t.data.result.q.map((ques, i) => {
                let ans = [];
                ques.a.map(a => {
                    ans.push({
                        "a_c": a.a_c
                    });
                });
                //console.log(ans)
                newq.push({
                    "q_c": ques.q_c,
                    "a": ans
                });
            });
            //console.log(newq);

            let n = {
                "data": {
                    "result": {
                        "q": newq
                    }
                }
            }
            //console.log(n);
            $("#json").val(JSON.stringify(n,null,2));
        } else if(t && t.data && t.data[0] && t.data[0].survey) {
            let ga = t.data.filter((g,i) =>{
                return g.survey.questions.length > 1
            });
            let rows = [];
            let defprops = {
                "wrapStrategy": "WRAP",
                "horizontalAlignment": "LEFT",
                "verticalAlignment": "TOP"
            }
            var addgame = (gamei) => {
              ga[gamei].survey.questions.map((qq,y) =>{
                  let values = [];
                  values.push({
                      "userEnteredValue": {
                          "stringValue": `${qq.content}`
                      },
                      "userEnteredFormat": {
                          ...defprops
                      }
                  });
                  values.push({
                      "userEnteredValue": {
                          "stringValue": `${qq.answers[0].content}`
                      },
                      "userEnteredFormat": {
                          ...defprops,
                          "backgroundColor": {
                              "red": 1,
                              "green": 1,
                              "blue": qq.answers[0].correct ? 0 : 1,
                              "alpha": 1,
                          },
                      }
                  });
                  values.push({
                      "userEnteredValue": {
                          "stringValue": `${qq.answers[1].content}`
                      },
                      "userEnteredFormat": {
                          ...defprops,
                          "backgroundColor": {
                              "red": 1,
                              "green": 1,
                              "blue": qq.answers[1].correct ? 0 : 1,
                              "alpha": 1,
                          },
                      }
                  });
                  values.push({
                      "userEnteredValue": {
                          "stringValue": `${qq.answers[2].content}`
                      },
                      "userEnteredFormat": {
                          ...defprops,
                          "backgroundColor": {
                              "red": 1,
                              "green": 1,
                              "blue": qq.answers[2].correct ? 0 : 1,
                              "alpha": 1,
                          },
                      }
                  });
                  rows.push({"values": values});
              })
            }
            addgame(0);
          
            var body = {
                "requests": [
                    {
                        "deleteRange": {
                            "range": {
                                "sheetId": 0,
                                "startRowIndex": 0,
                                "endRowIndex": 20,
                                "startColumnIndex": 0,
                                "endColumnIndex": 20
                            },
                            "shiftDimension": "ROWS"
                        }
                    },
                    {
                        "autoResizeDimensions": {
                            "dimensions": {
                                "sheetId": 0,
                                "dimension": "ROWS",
                                "startIndex": 0,
                                "endIndex": 20
                            },
                        },
                    },
                    {
                        "updateCells": {
                            "range": {
                                "sheetId": 0,
                                "startRowIndex": 0,
                                "startColumnIndex": 0
                            },
                            "rows": rows,
                            "fields": "*"
                        }
                    }
                ]
            }

            var x = gapi.client.sheets.spreadsheets.batchUpdate({spreadsheetId: `1GT_CzP6y9J1IJaQE9UdhUdb5EGRJW_Gd7jSrQXflOF4`}, body=body);
            x.then(function(response) {
                //console.log(response);
                $("#error").html("");
            }, function(reason) {
                console.error('error: ' + reason.result.error.message);
                $("#error").html("login first!");
            });
        }
    });

    let send = (ques, i, toaltchannel) => {
        var myEmbed = {
            color: hexToDecimal("#000000"),
            fields: [
                {
                    name: `Question ${Number(i)+1}`,
                    value: `[${ques.q_c}](${googlemain}${encodeURIComponent(ques.q_c)})`,
                    inline: false
                }
            ]
        };
        if(ques.a[0] && ques.a[0].a_c) {
            let x = ques.a[0].a_c;
            myEmbed.fields.push({
                name: `1`,
                value: `[${x}](${googlemain}${encodeURIComponent(x)})`,
                inline: false
            });
        }
        if(ques.a[1] && ques.a[1].a_c) {
            let x = ques.a[1].a_c;
            myEmbed.fields.push({
                name: `2`,
                value: `[${x}](${googlemain}${encodeURIComponent(x)})`,
                inline: false
            });
        }
        if(ques.a[2] && ques.a[2].a_c) {
            let x = ques.a[2].a_c;
            myEmbed.fields.push({
                name: `3`,
                value: `[${x}](${googlemain}${encodeURIComponent(x)})`,
                inline: false
            });
        }
        if(ques.a[3] && ques.a[3].a_c) {
            let x = ques.a[3].a_c;
            myEmbed.fields.push({
                name: `4`,
                value: `[${x}](${googlemain}${encodeURIComponent(x)})`,
                inline: false
            });
        }
        sendWH(myEmbed, toaltchannel);
    }

    $(".single").off().on("click", (e) =>{
        let t = $("#json").val()
        t = JSON.parse(t);
        let q = t.data.result.q;
        let id = $(e.target).attr("data-id");
        if(q) {
            send(q[id], id)
        }
        if($(e.target).next()) {
            $(e.target).next().focus();
        }
    });

    $("button#parse").on("click", () =>{
        let t = $("#json").val()
        t = JSON.parse(t);
        let q = t.data.result.q;
        if(q) {
            q.map((ques, i) => {
                setTimeout(()=>{
                    send(ques, i, true)
                }, i*1000);
            });
        }
    })

});
  </script>
<script>
    function makeApiCall() {
      var params = {
        // The spreadsheet to request.
        spreadsheetId: '1SuQffeygX9L8cyLp3ZfgYWjfJs8IVzHLrCXCoifO5ZE',  // TODO: Update placeholder value.

        // The ranges to retrieve from the spreadsheet.
        ranges: [],  // TODO: Update placeholder value.

        // True if grid data should be returned.
        // This parameter is ignored if a field mask was set in the request.
        includeGridData: true,  // TODO: Update placeholder value.
      };

      var request = gapi.client.sheets.spreadsheets.get(params);
      request.then(function(response) {
        // TODO: Change code below to process the `response` object:
        //console.log(response.result);
        $("#error").html("");
      }, function(reason) {
        console.error('error: ' + reason.result.error.message);
        $("#error").html("login first!");
      });
    }

    function initClient() {
      var API_KEY = 'AIzaSyBk1kt4KJdWlR5-sOaWpJMoMk_U0il3M0A';  // TODO: Update placeholder with desired API key.

      var CLIENT_ID = '92800070610-dhoe48qlsc06e1998j238sb1dffc637c.apps.googleusercontent.com';  // TODO: Update placeholder with desired client ID.

      // TODO: Authorize using one of the following scopes:
      //   'https://www.googleapis.com/auth/drive'
      //   'https://www.googleapis.com/auth/drive.file'
      //   'https://www.googleapis.com/auth/drive.readonly'
      //   'https://www.googleapis.com/auth/spreadsheets'
      //   'https://www.googleapis.com/auth/spreadsheets.readonly'
      var SCOPE = 'https://www.googleapis.com/auth/spreadsheets https://www.googleapis.com/auth/documents';

      gapi.client.init({
        'apiKey': API_KEY,
        'clientId': CLIENT_ID,
        'scope': SCOPE,
        'discoveryDocs': ['https://sheets.googleapis.com/$discovery/rest?version=v4', 'https://docs.googleapis.com/$discovery/rest?version=v1'],
      }).then(function() {
        gapi.auth2.getAuthInstance().isSignedIn.listen(updateSignInStatus);
        updateSignInStatus(gapi.auth2.getAuthInstance().isSignedIn.get());
      });
    }

    function handleClientLoad() {
      gapi.load('client:auth2', initClient);
    }

    function updateSignInStatus(isSignedIn) {
      if (isSignedIn) {
        makeApiCall();
      }
    }

    function handleSignInClick(event) {
      gapi.auth2.getAuthInstance().signIn();
    }
  
function instructions() {
  let defprops = {
      "userEnteredFormat": {
          "wrapStrategy": "WRAP",
          "horizontalAlignment": "CENTER",
          "verticalAlignment": "MIDDLE",
      }
  }
  let instructionrow = {"values": [
      {
          "userEnteredValue": {
              "stringValue": ``,
          },
          ...defprops
      },
      {
          "userEnteredValue": {
              "stringValue": ``,
          },
          "userEnteredFormat": {
              "wrapStrategy": "WRAP",
              "horizontalAlignment": "LEFT",
              "verticalAlignment": "TOP",
              "backgroundColor": {
                  "red": 1,
                  "green": 1,
                  "blue": 0,
                  "alpha": 1
              },
          }
      },
      {
          "userEnteredValue": {
              "stringValue": `HI-LITE CORRECT\nor\nUSE COLUMN`,
          },
          "userEnteredFormat": {
              "wrapStrategy": "WRAP",
              "horizontalAlignment": "CENTER",
              "backgroundColor": {
                  "red": 1,
                  "green": 1,
                  "blue": 0,
                  "alpha": 1
              },
          }
      },
      {
          "userEnteredValue": {
              "stringValue": ``,
          },
          "userEnteredFormat": {
              "wrapStrategy": "WRAP",
              "horizontalAlignment": "LEFT",
              "verticalAlignment": "TOP",
              "backgroundColor": {
                  "red": 1,
                  "green": 1,
                  "blue": 0,
                  "alpha": 1
              },
          }
      },
      {
          "userEnteredValue": {
              "stringValue": `<-----EASY HIGHLIGHT\nCOPY: CTRL+C\nPASTE: CTRL+ALT+V`,
          },
          "userEnteredFormat": {
              "wrapStrategy": "WRAP",
              "horizontalAlignment": "LEFT",
              "verticalAlignment": "TOP"
          }
      }
  ]};
  return instructionrow;
}
  
function CellData(cb) {
        let t = $("#json").val()
        t = JSON.parse(t);
        let q = t.data.result.q;
        let payload = [];
        if(q){
            var params = {
                spreadsheetId: '1SuQffeygX9L8cyLp3ZfgYWjfJs8IVzHLrCXCoifO5ZE',
                ranges: [],  // TODO: Update placeholder value.
                includeGridData: true,  // TODO: Update placeholder value.
            };

            var request = gapi.client.sheets.spreadsheets.get(params);
            request.then(function(response) {
                q.map((ques, i) => {
                    let defprops = {
                        "wrapStrategy": "WRAP",
                        "horizontalAlignment": "LEFT",
                        "verticalAlignment": "TOP"
                    }

                    let row = {
                        "values": [
                            {
                                "userEnteredValue": {
                                    "stringValue": `${q[i].q_c}`,
                                },
                                "userEnteredFormat": {
                                    ...defprops,
                                    "padding": {
                                        "bottom": 2
                                    }
                                }
                            },
                        ]
                    }
                    if(q[i].a) {
                        q[i].a.map((a, y) => {
                            let color = {
                                "red": 1,
                                "green": 1,
                                "blue": 1,
                                "alpha": 1,
                            }
                            try {
                                color = response.result.sheets[0].data[0].rowData[i].values[Number(y+1)].userEnteredFormat.backgroundColor;
                            } catch(e){}
                            row.values.push({
                                "userEnteredValue": {
                                    "stringValue": `${q[i].a[y].a_c}`,
                                },
                                "userEnteredFormat": {
                                    ...defprops,
                                    "backgroundColor": color,
                                }
                            });
                        });
                    }

                    payload.push(row)
                });

                cb(payload);
            }, function(reason) {
                console.error('error: ' + reason.result.error.message);
                $("#error").html("login first!");
                cb(null);
            });

        }
    }
  
function execute() {
        doc();
        let t = $("#json").val()
        t = JSON.parse(t);
        let q = t.data.result.q;
        let data = ''
        var params = {
            spreadsheetId: '1SuQffeygX9L8cyLp3ZfgYWjfJs8IVzHLrCXCoifO5ZE',
        };
        let payload = [];
        let dropdown = [];
        if(q) {
            var params = {
                spreadsheetId: '1SuQffeygX9L8cyLp3ZfgYWjfJs8IVzHLrCXCoifO5ZE',
                ranges: [],  // TODO: Update placeholder value.
                includeGridData: true,  // TODO: Update placeholder value.
            };

            var request = gapi.client.sheets.spreadsheets.get(params);
            request.then(function(response) {
                //console.log(response.result);
                q.map((ques, i) => {
                    let defprops = {
                        "wrapStrategy": "WRAP",
                        "horizontalAlignment": "LEFT",
                        "verticalAlignment": "TOP"
                    }

                    let row = {
                        "values": [
                            {
                                "userEnteredValue": {
                                    "stringValue": `${q[i].q_c}`,
                                },
                                "userEnteredFormat": {
                                    ...defprops,
                                    "padding": {
                                        "bottom": 2
                                    }
                                }
                            },
                        ]
                    }
                    if(q[i].a) {
                        q[i].a.map((a, y) => {
                            let color = {
                                "red": 1,
                                "green": 1,
                                "blue": 1,
                                "alpha": 1,
                            }
                            try {
                                color = response.result.sheets[0].data[0].rowData[i].values[Number(y+1)].userEnteredFormat.backgroundColor;
                            } catch(e){}
                            row.values.push({
                                "userEnteredValue": {
                                    "stringValue": `${q[i].a[y].a_c}`,
                                },
                                "userEnteredFormat": {
                                    ...defprops,
                                    "backgroundColor": color,
                                }
                            });
                        });
                        if(i>0) {
                            dropdown.push(
                                {
                                    "setDataValidation": {
                                        "range": {
                                            "sheetId": 0,
                                            "startRowIndex": i,
                                            "endRowIndex": i+1,
                                            "startColumnIndex": 4,
                                            "endColumnIndex": 5
                                        },
                                        "rule": {
                                            "condition": {
                                                "type": 'ONE_OF_LIST',
                                                "values": [
                                                    {
                                                        "userEnteredValue": `1) ${q[i].a[0].a_c}`,
                                                    },
                                                    {
                                                        "userEnteredValue": `2) ${q[i].a[1].a_c}`,
                                                    },
                                                    {
                                                        "userEnteredValue": `3) ${q[i].a[2].a_c}`,
                                                    },
                                                    {
                                                        "userEnteredValue": `not sure ???`,
                                                    },
                                                    {
                                                        "userEnteredValue": `maybe 1) ${q[i].a[0].a_c} ?`,
                                                    },
                                                    {
                                                        "userEnteredValue": `maybe 2) ${q[i].a[1].a_c} ?`,
                                                    },
                                                    {
                                                        "userEnteredValue": `maybe 3) ${q[i].a[2].a_c} ?`,
                                                    },                                                  
                                                ],
                                            },
                                            "showCustomUi": true,
                                            "strict": false
                                        }
                                    }
                                }
                            );
                        }
                        if(i==0) {
                            row.values.push({
                                "userEnteredValue": {
                                    "stringValue": `ANSWERS COLUMN`,
                                },
                                "userEnteredFormat": {
                                    ...defprops,
                                    "horizontalAlignment": "CENTER",
                                    "verticalAlignment": "MIDDLE",
                                    "textFormat": {
                                        "bold": true
                                    },
                                    "backgroundColor": {
                                        "red": 1,
                                        "green": 1,
                                        "blue": 0,
                                        "alpha": 1,
                                    },
                                }
                            });
                            row.values.push({
                                "userEnteredValue": {
                                    "stringValue": `NOTES`,
                                },
                                "userEnteredFormat": {
                                    ...defprops,
                                    "horizontalAlignment": "CENTER",
                                    "verticalAlignment": "MIDDLE",
                                    "textFormat": {
                                        "bold": true
                                    },
                                    "backgroundColor": {
                                        "red": 1,
                                        "green": 1,
                                        "blue": 0,
                                        "alpha": 1,
                                    },
                                }
                            });
                        } else {
                            row.values.push({
                                "userEnteredValue": {
                                    "stringValue": `Q${i+1} ANSWER`,
                                },
                                "userEnteredFormat": {
                                    ...defprops,
                                    "horizontalAlignment": "LEFT",
                                    "verticalAlignment": "MIDDLE",
                                    "textFormat": {
                                        "bold": true
                                    },
                                }
                            });
                        }
                    }

                    payload.push(row)
                });

                payload.push(instructions());

                let spreadsheet_id = '1SuQffeygX9L8cyLp3ZfgYWjfJs8IVzHLrCXCoifO5ZE'
                var body = {
                    "requests": [
                        {
                            "updateCells": {
                                "range": {
                                    "sheetId": 0,
                                    "startRowIndex": 0,
                                    "startColumnIndex": 0
                                },
                                "rows": payload,
                                "fields": "*"
                            }
                        },
                        ...dropdown
                    ]
                }

                var x = gapi.client.sheets.spreadsheets.batchUpdate({spreadsheetId: spreadsheet_id}, body=body);
                x.then(function(response) {
                    //console.log(response);
                    $("#error").html("");
                }, function(reason) {
                    console.error('error: ' + reason.result.error.message);
                    $("#error").html("login first!");
                });


            }, function(reason) {
                console.error('error: ' + reason.result.error.message);
                $("#error").html("login first!");
            });
        }
    }
  
    var reset = () => {
         var body = {
            "requests": [
                {
                    "deleteRange": {
                        "range": {
                            "sheetId": 0,
                            "startRowIndex": 0,
                            "endRowIndex": 20,
                            "startColumnIndex": 0,
                            "endColumnIndex": 20
                        },
                        "shiftDimension": "ROWS"
                    }
                },
                {
                    "autoResizeDimensions": {
                        "dimensions": {
                            "sheetId": 0,
                            "dimension": "ROWS",
                            "startIndex": 0,
                            "endIndex": 20
                        },
                    },
                },
                {
                    "updateCells": {
                        "range": {
                            "sheetId": 0,
                            "startRowIndex": 0,
                            "startColumnIndex": 0
                        },
                        "rows": [{"values": [{},{},{},{},{
                            "userEnteredValue": {
                                "stringValue": `ANSWERS COLUMN`,
                            },
                            "userEnteredFormat": {
                                "wrapStrategy": "WRAP",
                                "horizontalAlignment": "CENTER",
                                "verticalAlignment": "MIDDLE",
                                "textFormat": {
                                    "bold": true
                                },
                                "backgroundColor": {
                                    "red": 1,
                                    "green": 1,
                                    "blue": 0,
                                    "alpha": 1,
                                },
                            }
                        },{
                            "userEnteredValue": {
                                "stringValue": `NOTES`,
                            },
                            "userEnteredFormat": {
                                "wrapStrategy": "WRAP",
                                "horizontalAlignment": "CENTER",
                                "verticalAlignment": "MIDDLE",
                                "textFormat": {
                                    "bold": true
                                },
                                "backgroundColor": {
                                    "red": 1,
                                    "green": 1,
                                    "blue": 0,
                                    "alpha": 1,
                                },
                            }
                        }]}, {}, {}, {}, {}, {}, {}, {}, {}, {}, instructions()],
                        "fields": "*"
                    }
                }
            ]
        }

        var x = gapi.client.sheets.spreadsheets.batchUpdate({spreadsheetId: `1SuQffeygX9L8cyLp3ZfgYWjfJs8IVzHLrCXCoifO5ZE`}, body=body);
        x.then(function(response) {
            //console.log(response);
            $("#error").html("");
        }, function(reason) {
            console.error('error: ' + reason.result.error.message);
            $("#error").html("login first!");
        });

        var params = {
            documentId: '1fGcsJYqZrzSAA5b0GAgmqyTTAIYQBmN_V0Hx1RGysUY',
        };
        var request = gapi.client.docs.documents.get(params);
        request.then(function(response) {
            var lastindex = response.result.body.content.length - 1;
            let end = response.result.body.content[lastindex].endIndex - 1;
            var body = {
                "requests": [],
            };
            if(end > 1) {
                body.requests.push({"deleteContentRange":{"range":{"startIndex":1,"endIndex":end}}})
            }
            body.requests.push({
                "insertText": {
                    "text": `Q1) ----\n\t1) ----\n\t2) ----\n\t3) ----`,
                    "endOfSegmentLocation": {
                        "segmentId": "",
                    },
                },
            });
            body.requests.push({
                "insertText": {
                    "text": `\nQ1 ANSWER`,
                    "endOfSegmentLocation": {
                        "segmentId": "",
                    },
                },
            });
            body.requests.push({
                "insertTable":{
                    "rows": 1,
                    "columns": 1,
                    "endOfSegmentLocation": {
                        "segmentId": "",
                    },
                },
            });
            body.requests.push({
                "insertText": {
                    "text": `Q1 NOTES`,
                    "endOfSegmentLocation": {
                        "segmentId": "",
                    },
                },
            });
            body.requests.push({
                "insertText": {
                    "text": `\n\n\n\n\n\n==========================================================================================`,
                    "endOfSegmentLocation": {
                        "segmentId": "",
                    },
                },
            });

            body.requests.push({
                "insertText": {
                    "text": `\nQ2) ----\n\t1) ----\n\t2) ----\n\t3) ----`,
                    "endOfSegmentLocation": {
                        "segmentId": "",
                    },
                },
            });
            body.requests.push({
                "insertText": {
                    "text": `\nQ2 ANSWER`,
                    "endOfSegmentLocation": {
                        "segmentId": "",
                    },
                },
            });
            body.requests.push({
                "insertTable":{
                    "rows": 1,
                    "columns": 1,
                    "endOfSegmentLocation": {
                        "segmentId": "",
                    },
                },
            });
            body.requests.push({
                "insertText": {
                    "text": `Q2 NOTES`,
                    "endOfSegmentLocation": {
                        "segmentId": "",
                    },
                },
            });
            body.requests.push({
                "insertText": {
                    "text": `\n\n\n\n\n\n==========================================================================================`,
                    "endOfSegmentLocation": {
                        "segmentId": "",
                    },
                },
            });          
            var x = gapi.client.docs.documents.batchUpdate({documentId: `1fGcsJYqZrzSAA5b0GAgmqyTTAIYQBmN_V0Hx1RGysUY`}, body=body);
            x.then(function(response) {
                //console.log(response);
                $("#error").html("");
            }, function(reason) {
                console.error('error: ' + reason.result.error.message);
                $("#error").html("login first!");
            });
        }, function(reason) {
            console.error('error: ' + reason.result.error.message);
            $("#error").html("login first!");
        });
    }

    function refresh() {
      CellData((cellData) =>{
            var maxvalues = 0;
            cellData.map(row => {
                maxvalues = Math.max(maxvalues, row.values.length)
            });
            var body = {
                "requests": [
                    {
                        "updateCells": {
                            "range": {
                                "sheetId": 0,
                                "startRowIndex": 0,
                                "endRowIndex": cellData.length,
                                "startColumnIndex": 0,
                                "endColumnIndex": maxvalues
                            },
                            "rows": cellData,
                            "fields": "*"
                        }
                    }
                ]
            }

            var x = gapi.client.sheets.spreadsheets.batchUpdate({spreadsheetId: `1SuQffeygX9L8cyLp3ZfgYWjfJs8IVzHLrCXCoifO5ZE`}, body=body);
            x.then(function(response) {
                //console.log(response);
            }, function(reason) {
                console.error('error: ' + reason.result.error.message);
            });
        });
    }
  
    function doc() {
            var params = {
            documentId: '1fGcsJYqZrzSAA5b0GAgmqyTTAIYQBmN_V0Hx1RGysUY',
        };

        var request = gapi.client.docs.documents.get(params);
        request.then(function(response) {
            var lastindex = response.result.body.content.length - 1;
            let end = response.result.body.content[lastindex].endIndex - 1;
            //console.log(end);
            var body = {
                "requests": [],
            };
            if(end > 1) {
                body.requests.push({"deleteContentRange":{"range":{"startIndex":1,"endIndex":end}}})
            }

            let t = $("#json").val()
            t = JSON.parse(t);
            let q = t.data.result.q;
            if(q) {
                q.map((ques, i) => {
                    if(i>-1) {
                        let text = "";
                        ques.a.map((ans,y)=>{
                            text += `\t${y+1}) ${ans.a_c}\n`;
                        });
                        body.requests.push({
                            "insertText": {
                                "text": `${i==0 ? '' : '\n'}Q${i+1}) ${ques.q_c}\n${text}`,
                                "endOfSegmentLocation": {
                                    "segmentId": "",
                                },
                            },
                        });
                        body.requests.push({
                            "insertText": {
                                "text": `Q${i+1} ANSWER`,
                                "endOfSegmentLocation": {
                                    "segmentId": "",
                                },
                            },
                        });
                        body.requests.push({
                            "insertTable":{
                                "rows": 1,
                                "columns": 1,
                                "endOfSegmentLocation": {
                                    "segmentId": "",
                                },
                            },
                        });
                        body.requests.push({
                            "insertText": {
                                "text": `Q${i+1} NOTES`,
                                "endOfSegmentLocation": {
                                    "segmentId": "",
                                },
                            },
                        });
                        body.requests.push({
                            "insertText": {
                                "text": `\n\n\n\n\n\n==========================================================================================`,
                                "endOfSegmentLocation": {
                                    "segmentId": "",
                                },
                            },
                        });
                    }
                });
            }

            var x = gapi.client.docs.documents.batchUpdate({documentId: `1fGcsJYqZrzSAA5b0GAgmqyTTAIYQBmN_V0Hx1RGysUY`}, body=body);
            x.then(function(response) {
                //console.log(response);
                $("#error").html("");
            }, function(reason) {
                console.error('error: ' + reason.result.error.message);
                $("#error").html("login first!");
            });


        }, function(reason) {
            console.error('error: ' + reason.result.error.message);
            $("#error").html("login first!");
        });  
    }
    
    function reverseQ() {
        $("#compact").click();
        let t = $("#json").val()
        t = JSON.parse(t);
        let q = t.data.result.q;
        q = q.reverse();
        t.data.result.q = q;
        $("#json").val(JSON.stringify(t,null,2));
        localStorage.setItem("display",JSON.stringify(t));
        doc();
    }
  
    </script>
    <script async defer src="https://apis.google.com/js/api.js"
      onload="this.onload=function(){};handleClientLoad()"
      onreadystatechange="if (this.readyState === 'complete') this.onload()">
    </script>  
</head>
  
<body>
  <textarea id='json'></textarea>
  <div id="buttons">
    <label for="debug">debug</label>
    <input type='checkbox' id='debug'></input>
    <button id='compact'>compact</button>
    <button id='parse'>all</button>
  </div>
  <div style="margin-top:10px;">
    <button id="signin-button" onclick="handleSignInClick()">Sign in</button>
    <button id="exe" onclick="execute()">pop sheet</button>
    <button id="refresh" onclick="refresh()">refresh sheet</button>
    <button id="rev" onclick="reverseQ()">reverse</button>
  </div>
  <div style="margin-top:10px;">
    <button id="doc" onclick="doc()">doc</button>
  </div>  
  <div style="margin-top:50px;">
    <button id="reset" onclick="reset()">clear sheet</button>
    <span id='error' style="margin-left:10px; color: red; font-weight:bold"></span>
  </div>

</body>
